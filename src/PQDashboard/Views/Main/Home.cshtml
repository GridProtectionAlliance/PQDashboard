@*******************************************************************************************************
    //  Home.cshtml - Gbtc
    //
    //  Copyright © 2016, Grid Protection Alliance.  All Rights Reserved.
    //
    //  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See
    //  the NOTICE file distributed with this work for additional information regarding copyright ownership.
    //  The GPA licenses this file to you under the MIT License (MIT), the "License"; you may not use this
    //  file except in compliance with the License. You may obtain a copy of the License at:
    //
    //      http://opensource.org/licenses/MIT
    //
    //  Unless agreed to in writing, the subject software distributed under the License is distributed on an
    //  "AS-IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the
    //  License for the specific language governing permissions and limitations.
    //
    //  Code Modification History:
    //  ----------------------------------------------------------------------------------------------------
    //  01/22/2016 - J. Ritchie Carroll
    //       Generated original version of source code.
    //
    //*****************************************************************************************************@
@using System.Web.WebPages
@using GSF.Collections;
@using GSF.Data.Model
@using GSF.Web.Model
@using PQDashboard.Model
@using Newtonsoft.Json
@using openXDA.Model

@model AppModel
@{
    Layout = "";
    string historianConnection;
    IEnumerable<AssetGroup> assetGroups;
    int meterCount;
    string xdaInstance;
    string yearBegin;

    using(DataContext dataContext = new DataContext("systemSettings")) {
        historianConnection = dataContext.Table<Setting>().QueryRecordWhere("Name = 'Historian.URL'")?.Value ?? "127.0.0.0";
        assetGroups = dataContext.Table<AssetGroup>().QueryRecords();
        meterCount = dataContext.Connection.ExecuteScalar<int>("SELECT COUNT(*) FROM Meter WHERE ID IN (SELECT MeterID FROM MeterAssetGroup WHERE AssetGroupID IN (SELECT AssetGroupID FROM UserAccountAssetGroup WHERE UserAccountID =  (SELECT ID FROM UserAccount WHERE Name = {0})))", ViewBag.usersid);
        xdaInstance = dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'System.XDAInstance'");
        yearBegin = dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'YearBeginDate'") ?? "January 1";

        ViewBag.DateRange = dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM UserDashSettings WHERE Name = 'System.DefaultView.DateRange'") ?? dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'System.DefaultView.DateRange'") ?? "2";
        ViewBag.Tab = dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM UserDashSettings WHERE Name = 'System.DefaultView.Tab'") ?? dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'System.DefaultView.Tab'") ?? "Events";
        ViewBag.MapGrid =  dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM UserDashSettings WHERE Name = 'System.DefaultView.MapGrid'") ?? dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'System.DefaultView.MapGrid'") ?? "Grid";
        ViewBag.AssetGroup = dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM UserDashSettings WHERE Name = 'System.DefaultView.AssetGroup'") ??  dataContext.Connection.ExecuteScalar<string>("SELECT Value FROM DashSettings WHERE Name = 'System.DefaultView.AssetGroup'") ?? "1";

    }

    int defaulAssetGroupID = -1;

    if (assetGroups.Any())
    {
        defaulAssetGroupID = assetGroups.First().ID;
    }

    string[] tabs = new[] { "Events", "Disturbances", "Faults", "Breakers","Extensions", "Trending", "Completeness", "Correctness" };
}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Open PQ Dashboard :: @ViewBag.username</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="shortcut icon" type="image/ico" href="~/favicon.ico" />
    <link href="@Url.Content("~/@GSF/Web/Shared/Content/bootstrap.css")" rel="stylesheet">
    <link href="@Url.Content("~/@GSF/Web/Shared/Content/font-awesome.css")" rel="stylesheet">
    <link href="@Url.Content("~/@GSF/Web/Shared/Content/jquery-ui.css")" rel="stylesheet">
    <link href="~/Content/jquery.jspanel.css" rel="stylesheet">
    @Styles.Render("~/Content/primeui")
    @Styles.Render("~/Content/Default")
    <link rel="stylesheet" href="~/Content/daterangepicker.css" />
    <link rel="stylesheet" type="text/css" href="~/Scripts/Leaflet/leaflet1.0.css" />
    <style>
        .modal-dialog {
            z-index: 10000;
        }
    </style>
    <script>
        var mg = @defaulAssetGroupID;
        var homePath = '@Html.Raw(Url.Content("~/"))';
        var historianConnection = '@historianConnection';
        var xdaInstance = '@xdaInstance';
        var yearBegin = '@yearBegin';
        var userId = '@ViewBag.usersid';
        var defaultView = { DateRange: @Html.Raw(ViewBag.DateRange), Tab: '@Html.Raw(ViewBag.Tab)', MapGrid: '@Html.Raw(ViewBag.MapGrid)', AssetGroup: @Html.Raw(ViewBag.AssetGroup)};
        var userName = '@ViewBag.username';
    </script>
    @if (Request.Browser.Browser == "InternetExplorer") {
        <script src="~/Scripts/default.polyfill.min.js"></script>
    }
    @Scripts.Render("~/Scripts/jquery")
    @Scripts.Render("~/Scripts/bootstrap")
    @Scripts.Render("~/Scripts/random")
    @Scripts.Render("~/Scripts/PrimeUI/primeui")
    @Scripts.Render("~/Scripts/default")
    @Scripts.Render("~/Scripts/others")
    @Scripts.Render("~/Scripts/D3/d3")
    @Scripts.Render("~/Scripts/Leaflet/leaflet")
    @Scripts.Render("~/Scripts/flot/flot")

    <script src="~/Scripts/ie11-compatibility-functions.js"></script>

</head>

<body>

<div id="draggable" class="ui-widget-content"></div>
<div style="width: 100%; height: 36px;">
    <table width="100%">
        <tr>
            <td width="33%" align="left"><img src="~/Images/GPA-Logo---30-pix(on-white).png"/></td>
            <td width="33%" align="center"><img src="~/Images/PQ-Dashboard.png"/></td>
            <td width="34%" align="right" valign="top" nowrap><img src="~/Images/EPRI(c).jpg"/></td>
        </tr>
    </table>
</div>


<div id="ApplicationContent" class="noselect">
    <div id="headerStrip" class="headerStrip ui-state-default noselect">
        <table style="width: 100%;">
            <tr>
                <td width="250px" align="left" style="z-index: 999; padding-left: 5px;" nowrap>
                    Asset Group:
                    <select id="meterGroupSelect" class="smallbutton" style="height: 20px" onchange="selectMeterGroup(this);" >
                        @foreach (AssetGroup mg in assetGroups)
                        {
                            <option value="@mg.ID">@mg.Name</option>
                        }
                    </select>
                </td>
                <td width="150px" align="left" nowrap>
                    <span id="meterSelected"></span> of <span id="meterCount">@meterCount</span> devices
                </td>

                <td width="auto" align="center" nowrap>
                    <div class="row" style="width:350px">
                        <div class="col-md-2">
                            <button type="button" class="btn btn-sm btn-default" onclick="moveDateBackward()" title="Move 1 step back in time"><span class="glyphicon glyphicon-backward"></span></button>
                        </div>
                        <div class="col-md-8">
                        
                            <div id="dateRange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 215px">

                                <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;
                                <span id="dateRangeSpan"></span> <b class="caret"></b>

                            </div>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="btn btn-sm btn-default" onclick="moveDateForward()" title="Move 1 step forward in time"><span class="glyphicon glyphicon-forward"></span></button>
                        </div>

                    </div>


                </td>
                <td width="100px" align="right" style="z-index: 999; padding-right: 20px;" nowrap>
                    <span>@ViewBag.username</span>
                </td>
                <td width="150px" align="right" style="z-index: 999; padding-right: 5px;" nowrap>
                    <a class="btn btn-sm btn-default" href="@Url.Action("QuickSearch")" target="_blank">Quick Search</a>
                </td>
                @if (ViewBag.username != "External")
                {
                    <td width="35px" align="right" style="z-index: 999; padding-right: 5px;" >
                        <button type="button" title="View page settings" data-toggle="modal" data-target="#settingsModal"><span class="glyphicon glyphicon-cog"></span></button>
                    </td>
                }

            </tr>
        </table>
    </div>

    <div id="application-tabs" class="noselect">
        <ul>
            <li id="tabsMeterActivity"><a href="#tabs-MeterActivity">Event Search</a></li>
            <li id="tabsEvents"><a href="#tabs-Events">Events</a></li>
            <li id="tabsDisturbances"><a href="#tabs-Disturbances">Disturbances</a></li>
            <li id="tabsFaults"><a href="#tabs-Faults">Faults</a></li>
            <li id="tabsBreakers"><a href="#tabs-Breakers">Breakers</a></li>
            <li id="tabsExtensions"><a href="#tabs-Extensions">Extensions</a></li>
            <li id="tabsTrending"><a href="#tabs-Trending">Trending</a></li>
            <li id="tabsTrendingData"><a href="#tabs-TrendingData">TrendingData</a></li>
            <li id="tabsCompleteness"><a href="#tabs-Completeness">Completeness</a></li>
            <li id="tabsCorrectness"><a href="#tabs-Correctness">Correctness</a></li>
            <li id="tabsModbusData"><a href="#tabs-ModbusData">ModbusData</a></li>
            <li id="tabsHistorianData"><a href="#tabs-HistorianData">HistorianData</a></li>
        </ul>

        <div id="tabs-MeterActivity" style="background-color: #064e1b; width: 100%; height: 100%">
        </div>

        <div id="tabs-ModbusData">
            <iframe id="modbusFrame"></iframe>
        </div>

        <div id="tabs-HistorianData">
            <iframe id="historianFrame"></iframe>
        </div>

        <div id="tabs-TrendingData">
            <div id="column_5" class="column resizeable">
                <div class="portlet" id="Portlet1TrendingData">
                    <div class="portlet-header">
                        <div class="portlet-header-text" style="display: inline">Trending Data Overview (Past 30 Days)</div>
                    </div>
                    <div id="DockOverviewTrendingData" class="portlet-content theDockOverviewStyle">
                        <div id="OverviewTrendingData" class="docklet">
                        </div>
                    </div>
                </div>
                <div class="portlet" id="Portlet2TrendingData">
                    <div class="portlet-header">
                        <div class="portlet-header-text" style="display: inline">
                            Trending Data Detail for
                            <div style="display: inline;" id="trendingDataDetailHeader">Date</div>
                            &nbsp;(24 Hours)
                        </div>
                    </div>
                    <div id="DockDetailTrendingData" class="portlet-content theDockDetailStyle">
                        <div id="DetailTrendingData" class="docklet">
                            <div id="DetailTrendingDataTable"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="column_6" class="column">
                <div class="portlet">
                    <div class="portlet-header portlet-header-text">
                        <div class="header-container">
                            <div class="siteselectdropdown" style="position: absolute;">
                                <select class="smallbutton mapGrid" id="mapTrendingDataGrid" onchange="selectmapgrid(this);">
                                    <option value="Map">Map</option>
                                    <option value="Grid">Grid</option>
                                </select>
                                <select class="smallbutton" id="selectSiteSetTrendingData" onchange="showSiteSet(this);">
                                    <option value="All">All Sites</option>
                                    <option value="RecievedData">Recieved Data</option>
                                    <option value="NoData">No Data</option>
                                    <option value="SelectedSites">Selected Sites</option>
                                    <option value="None">None</option>
                                </select>
                                <select class="smallbutton" id="trendingDataTypeSelection" onchange="showType(this);">
                                    <option value="Average">Average</option>
                                    <option value="Maximum">Maximum</option>
                                    <option value="Minimum">Minimum</option>
                                </select>
                                <select class="smallbutton" id="contourColorScaleSelect" onchange="showColorScale(this);">
                                </select>
                                <button onclick="stepOutGrid()" class="gridStepOut" style="display:none">Step Out</button>

                            </div>
                            <div class="overlaydate pull-right">
                                <div id="mapHeaderTrendingDataFrom" class="mapheader noselect"></div>
                                <div id="mapHeaderTrendingDataDivider" class="mapheader noselect">&nbsp;-&nbsp;</div>
                                <div id="mapHeaderTrendingDataTo" class="mapheader noselect"></div>
                            </div>


                        </div>
                    </div>
                    <div id="MapMatrixTrendingData" class="portlet-content portlet-header-text">
                        <div class="theMapStyle" id="theMapTrendingData">
                        </div>
                        <div class="theMatrixStyle noselect" id="theMatrixTrendingData"></div>
                    </div>
                </div>
            </div>
        </div>

        @foreach (string tab in tabs)
        {
            <div id="tabs-@(tab)">
                <div id="column_1" class="column resizeable">
                    <div class="portlet" id="Portlet1@(tab)">
                        <div class="portlet-header">
                            <div class="portlet-header-text" style="display: inline">@(tab) Overview (<span class="contextWindow"></span>)</div>
                            @if (tab == "Disturbances")
                            {
                                <select class="smallbutton pull-right" style="margin-right: 20px" onchange="showMagDur(this)">
                                    <option value="0">Bar Chart</option>
                                    <option value="1">Mag/Dur Chart</option>
                                </select>
                            }
                        </div>
                        <div id="DockOverview@(tab)" class="portlet-content theDockOverviewStyle">
                            <div id="Overview@(tab)" style="height: auto" class="docklet chart-container"></div>
                            <div id="Overview@(tab)Overview" style="height: 100px; bottom: 0" class="docklet chart-container"></div>
                            @if (tab == "Disturbances")
                            {
                                <div id="OverviewDisturbancesMagDur" class="docklet chart-container" style="display: none"></div>
                            }
                        </div>
                    </div>
                    <div class="portlet" id="Portlet2@(tab)">
                        <div class="portlet-header">
                            <div class="portlet-header-text" style="display: inline">
                                @tab Detail for <span class="contextWindow"></span>
                            </div>
                            @if (tab == "Faults")
                            {
                                <button class="btn btn-xs btn-default pull-right" style="margin-right: 20px" onclick="openFaultDetailsByDateXDAPage()">View in OpenXDA</button>
                            }
                        </div>
                        <div id="DockDetail@(tab)" class="portlet-content noselect theDockDetailStyle">
                            <div id="Detail@(tab)" class="docklet">
                                <div id="Detail@(tab)Table"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="column_2" class="column">
                    <div class="portlet">
                        <div class="portlet-header portlet-header-text">
                            <div class="header-container">
                                <div class="siteselectdropdown" style="position: absolute;">
                                    <select class="smallbutton mapGrid" id="map@(tab)Grid" onchange="selectmapgrid(this);">
                                        <option value="Map">Map</option>
                                        <option value="Grid">Grid</option>
                                    </select>
                                    <select class="smallbutton" id="selectSiteSet@(tab)" onchange="showSiteSet(this);">
                                        <option value="All">All Sites</option>
                                        <option value="Events">@(tab == "Events" ? "" : tab.Trim('s') + " ")Events</option>
                                        <option value="NoEvents">No @(tab == "Events" ? "" : tab.Trim('s') + " ")Events</option>
                                        <option value="SelectedSites">Selected Sites</option>
                                        <option value="None">None</option>
                                    </select>
                                    @if (tab == "Events")
                                    {
                                    <select class="smallbutton" id="selectHeatmap@(tab)" onchange="showHeatmap(this);">
                                        <option value="EventCounts">Event Counts</option>
                                        <option value="MinimumSags">Sag Minimum</option>
                                        <option value="MaximumSwell">Swell Maximum</option>
                                    </select>
                                    }
                                    <button onclick="stepOutGrid()" class="gridStepOut" style="display:none">Step Out</button>
                                </div>

                                <div class="overlaydate pull-right">
                                    <div id="mapHeader@(tab)From" class="mapheader"></div>
                                    <div id="mapHeader@(tab)Divider" class="mapheader">&nbsp;-&nbsp;</div>
                                    <div id="mapHeader@(tab)To" class="mapheader"></div>
                                </div>

                            </div>

                        </div>

                        <div id="MapMatrix@(tab)" class="portlet-content portlet-header-text">
                            <div class="theMapStyle" id="theMap@(tab)"></div>
                            <div class="theMatrixStyle noselect" id="theMatrix@(tab)"></div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

</div>


@Html.Partial("Settings")

<div id="notesModal" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 50%">

        <!-- Modal content-->
        <div class="modal-content" >
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Add a note to record <span id="faultId"></span></h4>
            </div>
            <div id="previousNotesDiv">
                
            </div>
            <div class="modal-body">
                <textarea id="note" class="form-control"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="saveNote()">Save</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>

<script>
    if (!Array.prototype.flat) {
          Array.prototype.flat = function(depth) {
            var flattened = [];
            (function flat(array, depth) {
                for (var index = 0; index < array.length; index++) {
                if (Array.isArray(array[index]) && depth > 0) {
                  flat(array[index], depth - 1); 
                } else {
                  flattened.push(array[index]);
                }
              }
            })(this, Math.floor(depth) || 1);
            return flattened;
          };
        }
    const DateTimeFormat = '@Model.Global.DateTimeFormat'
    //////////////////////////////////////////////////////////////////////////////////////////////////////////
    // The following function are for making button links to another page and opening another page
    function filterMakeFaultSpecificsButton_html(id) {
        var return_html = "";
        if (id.eventtype == "Fault") {
            return_html = makeFaultSpecificsButton_html(id);
        }
        return (return_html);
    }

    function makeFaultSpecificsButton_html(id) {
        var return_html = "";
        return_html += '<div style="width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onClick="OpenWindowToFaultSpecifics(' + id.theeventid + ');" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Open Fault Detail Window">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/faultDetailButton.png"))" /></button></div>';
        return (return_html);
    }

    function OpenWindowToFaultSpecifics(id) {
        var datarow = id;
        var popup = window.open("@Html.Raw(Url.Content("~/FaultSpecifics.aspx"))?eventid=" + id, id + "FaultLocation", "left=0,top=0,status=no,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no");
        return false;
    }

    function makeOpenSEEButton_html(id) {
        var return_html = "";
        return_html += '<div style="cursor: pointer; width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onClick="OpenWindowToOpenSEE(' + id.theeventid + ',' + id.breakeroperationid + ');" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Launch OpenSEE Waveform Viewer">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/seeButton.png"))" /></button></div>';
        return (return_html);
    }

    function makeOpenSTEButton_html(id) {
        var return_html = "";
        var url = "'@Html.Raw(Url.Content("~/Main/openSTE"))?channelid=" + encodeURIComponent(id.channelid)
            + "&date=" + encodeURIComponent(id.date)
            + "&meterid=" + encodeURIComponent(id.meterid)
            + "&measurementtype=" + encodeURIComponent(id.measurementtype)
            + "&characteristic=" + encodeURIComponent(id.characteristic)
            + "&phasename=" + encodeURIComponent(id.phasename) + "'";
        return_html += '<div style="cursor: pointer; width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onclick="OpenWindowToOpenSTE( ' + url + ',' + id.channelid + ' )" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Launch OpenSTE Trending Viewer">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/steButton.png"))" /></button></div>';
        return (return_html);
    }

    function OpenWindowToOpenSTE(url, id) {
        var popup = window.open(url, id + "openSTE");
        return false;
    }


    function OpenWindowToOpenSEE(id, breaker) {
        var url = "@Html.Raw(Url.Content("~/Main/OpenSEE"))?eventid=" + id;

        if (currentTab === "Breakers")
            url += "&breakeroperation=" + breaker + "&breakerdigitals=1";
        else
            url += "&faultcurves=1";

        var popup = window.open(url, id + "openSEE");
        return false;
    }

    function makeChannelDataQualityButton_html(id) {
        var return_html = "";
        return_html += '<div style="cursor: pointer; width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onClick="OpenWindowToChannelDataQuality(' + id.theeventid + ');" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Launch Channel Data Quality Details Page">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/dqDetailButton.png"))" /></button></div>';
        return (return_html);
    }

    function makeChannelCompletenessButton_html(id) {
        var return_html = "";
        return_html += '<div style="cursor: pointer; width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onClick="OpenWindowToChannelDataCompleteness(' + id.theeventid + ');" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Launch Channel Data Quality Details Page">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/dcDetailButton.png"))" /></button></div>';
        return (return_html);
    }

    function makeMeterEventsByLineButton_html(id) {
        var return_html = "";
        return_html += '<div style="cursor: pointer; width: 100%; Height: 100%; text-align: center; margin: auto; border: 0 none;">';
        return_html += '<button onClick="OpenWindowToMeterEventsByLine(' + id.theeventid + ');" value="" style="cursor: pointer; text-align: center; margin: auto; border: 0 none;" title="Launch Events List Page">';
        return_html += '<img src="@Html.Raw(Url.Content("~/Images/eventDetailButton.png"))" /></button></div>';
        return (return_html);
    }

    function OpenWindowToMeterEventsByLine(id) {
        var popup = window.open("@Html.Raw(Url.Content("~/Main/MeterEventsByLine"))?eventid=" + id + "&context="+globalContext, id + "MeterEventsByLine");
        return false;
    }

    function OpenWindowToMeterEventsByLineTwo(id, context, sourcedate) {
        var popup = window.open("@Html.Raw(Url.Content("~/Main/MeterEventsByLine"))?eventid=" + id + "&context="+context +"&posteddate="+sourcedate, id + "MeterEventsByLine");
        return false;
    }

    function OpenWindowToMeterDisturbancesByLine(id) {
        var popup = window.open("@Html.Raw(Url.Content("~/Main/MeterDisturbancesByLine"))?eventid=" + id + "&context="+globalContext, id + "MeterDisturbancesByLine");
        return false;
    }

    function OpenWindowToMeterExtensionsByLine(id) {
        var popup = window.open("@Html.Raw(Url.Content("~/Main/MeterExtensionsByLine"))?eventid=" + id + "&context="+globalContext, id + "MeterEventsByLine");
        return false;
    }


    function OpenWindowToChannelDataQuality(id) {
        var popup = window.open("@Html.Raw(Url.Content("~/ChannelDataQuality.aspx"))?eventid=" + id, id + "ChannelDataQuality");
        return false;
    }

    function OpenWindowToChannelDataCompleteness(id) {
        var popup = window.open("@Html.Raw(Url.Content("~/ChannelDataCompleteness.aspx"))?eventid=" + id, id + "ChannelDataCompleteness");
        return false;
    }

    function openFaultDetailsByDateXDAPage(){
        if(contextfromdate == contexttodate){
            window.open(xdaInstance + "/Workbench/FaultsDetailsByDate.cshtml?MeterIds=" + meterList.selectedIdsString() + "&Date=" + contexttodate + "&context=" + globalContext)
        }
    }

    function stepOutGrid() {
        $('#meterGroupSelect').val(meterList.ParentID);
        $('#meterGroupSelect').trigger('change');
        return;
    }
    </script>

</body>

</html>
